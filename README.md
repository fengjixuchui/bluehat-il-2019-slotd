This is the code from the BlueHat IL 2019 CTF. The vulnerability is a Use-After-Free of the dtor member of a user object.
